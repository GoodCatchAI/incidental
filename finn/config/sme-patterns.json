{
  "patterns": [
    {
      "id": "react-hooks-conditional",
      "name": "Conditional Hook Call",
      "category": "hooks",
      "pattern": "if\\s*\\([^)]*\\)\\s*\\{[^}]*use[A-Z]\\w*\\(",
      "message": "Hooks cannot be called inside conditions - this breaks the Rules of Hooks",
      "suggestion": "Move the hook call outside the condition and use the condition inside the hook callback or result",
      "severity": "error",
      "documentationUrl": "https://react.dev/reference/rules/rules-of-hooks",
      "agentId": "sme-react"
    },
    {
      "id": "react-hooks-loop",
      "name": "Hook Inside Loop",
      "category": "hooks",
      "pattern": "(?:for|while)\\s*\\([^)]*\\)\\s*\\{[^}]*use[A-Z]\\w*\\(",
      "message": "Hooks cannot be called inside loops - this breaks the Rules of Hooks",
      "suggestion": "Move hooks outside the loop or use a different pattern like mapping with keys",
      "severity": "error",
      "documentationUrl": "https://react.dev/reference/rules/rules-of-hooks",
      "agentId": "sme-react"
    },
    {
      "id": "react-hooks-nested-function",
      "name": "Hook in Nested Function",
      "category": "hooks",
      "pattern": "(?:function\\s+\\w+|const\\s+\\w+\\s*=\\s*(?:async\\s*)?\\([^)]*\\)\\s*=>)\\s*\\{[^}]*use[A-Z]\\w*\\(",
      "message": "Hooks should only be called at the top level of a React function component",
      "suggestion": "Move the hook to the top level of your component",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/rules/rules-of-hooks",
      "agentId": "sme-react"
    },
    {
      "id": "react-useeffect-no-deps",
      "name": "useEffect Without Dependencies",
      "category": "hooks",
      "pattern": "useEffect\\s*\\(\\s*(?:async\\s*)?\\(\\)\\s*=>\\s*\\{[^}]+\\}\\s*\\)\\s*;?\\s*$",
      "message": "useEffect without dependency array runs on every render - likely unintended",
      "suggestion": "Add a dependency array (empty [] for mount-only, or [deps] for specific triggers)",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/react/useEffect#specifying-reactive-dependencies",
      "agentId": "sme-react"
    },
    {
      "id": "react-useeffect-object-dep",
      "name": "Object/Array in useEffect Dependencies",
      "category": "hooks",
      "pattern": "useEffect\\s*\\([^,]+,\\s*\\[\\s*(?:\\{|\\[)",
      "message": "Inline objects/arrays in dependencies cause infinite loops (new reference each render)",
      "suggestion": "Use useMemo to memoize objects/arrays, or move them outside component",
      "severity": "error",
      "documentationUrl": "https://react.dev/reference/react/useEffect#removing-unnecessary-object-dependencies",
      "agentId": "sme-react"
    },
    {
      "id": "react-inline-function-prop",
      "name": "Inline Function in JSX Props",
      "category": "performance",
      "pattern": "<\\w+[^>]*\\s(?:on\\w+|render\\w*|component)=\\{(?:\\([^)]*\\)|[^}]*)\\s*=>",
      "message": "Inline arrow functions in JSX create new function instances on every render",
      "suggestion": "Extract to useCallback or define outside render for stable reference",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useCallback",
      "agentId": "sme-react"
    },
    {
      "id": "react-inline-object-prop",
      "name": "Inline Object in JSX Props",
      "category": "performance",
      "pattern": "<\\w+[^>]*\\sstyle=\\{\\{",
      "message": "Inline style objects create new references on every render",
      "suggestion": "Use useMemo, define styles outside component, or use CSS/className",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useMemo",
      "agentId": "sme-react"
    },
    {
      "id": "react-array-index-key",
      "name": "Array Index as Key",
      "category": "performance",
      "pattern": "\\.map\\s*\\([^)]*,\\s*(?:index|i|idx)\\s*\\)[^}]*key\\s*=\\s*\\{?\\s*(?:index|i|idx)\\s*\\}?",
      "message": "Using array index as key can cause issues with reordering and state",
      "suggestion": "Use a unique, stable identifier from your data as the key",
      "severity": "warning",
      "documentationUrl": "https://react.dev/learn/rendering-lists#why-does-react-need-keys",
      "agentId": "sme-react"
    },
    {
      "id": "react-missing-key",
      "name": "Missing Key in List",
      "category": "performance",
      "pattern": "\\.map\\s*\\([^)]*\\)\\s*=>\\s*<(?!.*\\bkey\\s*=)",
      "message": "List items should have a unique key prop for efficient reconciliation",
      "suggestion": "Add a key prop with a unique, stable identifier",
      "severity": "warning",
      "documentationUrl": "https://react.dev/learn/rendering-lists#keeping-list-items-in-order-with-key",
      "agentId": "sme-react"
    },
    {
      "id": "react-usememo-missing",
      "name": "Expensive Computation Without useMemo",
      "category": "performance",
      "pattern": "(?:const|let)\\s+\\w+\\s*=\\s*\\w+\\.(?:filter|map|reduce|sort)\\([^)]+\\)\\.(?:filter|map|reduce|sort)\\(",
      "message": "Chained array operations run on every render without memoization",
      "suggestion": "Wrap expensive computations in useMemo with appropriate dependencies",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useMemo",
      "agentId": "sme-react"
    },
    {
      "id": "react-setstate-in-render",
      "name": "setState in Render",
      "category": "state",
      "pattern": "(?:return|=>)\\s*(?:\\(|\\{)?[^}]*set[A-Z]\\w*\\(",
      "message": "Calling setState during render causes infinite loops",
      "suggestion": "Move state updates to useEffect or event handlers",
      "severity": "error",
      "documentationUrl": "https://react.dev/learn/queueing-a-series-of-state-updates",
      "agentId": "sme-react"
    },
    {
      "id": "react-state-mutation",
      "name": "Direct State Mutation",
      "category": "state",
      "pattern": "\\w+\\.(push|pop|shift|unshift|splice|sort|reverse)\\s*\\(",
      "message": "Mutating state directly breaks React reactivity",
      "suggestion": "Create a new array/object: [...array, newItem] or {...object, key: value}",
      "severity": "error",
      "documentationUrl": "https://react.dev/learn/updating-arrays-in-state",
      "agentId": "sme-react"
    },
    {
      "id": "react-usestate-object",
      "name": "Large Object in Single useState",
      "category": "state",
      "pattern": "useState\\s*\\(\\s*\\{(?:[^}]*,){4,}",
      "message": "Large state objects may indicate need for useReducer or splitting state",
      "suggestion": "Consider useReducer for complex state, or split into multiple useState calls",
      "severity": "info",
      "documentationUrl": "https://react.dev/learn/extracting-state-logic-into-a-reducer",
      "agentId": "sme-react"
    },
    {
      "id": "react-class-component",
      "name": "Class Component",
      "category": "patterns",
      "pattern": "class\\s+\\w+\\s+extends\\s+(?:React\\.)?(?:Component|PureComponent)",
      "message": "Class components are legacy - functional components with hooks are preferred",
      "suggestion": "Convert to functional component with useState and useEffect",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/Component",
      "agentId": "sme-react"
    },
    {
      "id": "react-forwardref-missing",
      "name": "DOM Ref Without forwardRef",
      "category": "patterns",
      "pattern": "(?:const|function)\\s+[A-Z]\\w*\\s*[=:][^{]*\\{[^}]*ref\\s*[=:]",
      "message": "Custom components receiving ref prop need forwardRef",
      "suggestion": "Wrap component in React.forwardRef to pass ref to DOM element",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/react/forwardRef",
      "agentId": "sme-react"
    },
    {
      "id": "react-prop-spreading",
      "name": "Prop Spreading Without Type Safety",
      "category": "patterns",
      "pattern": "<\\w+\\s+\\{\\.\\.\\.\\w+\\}",
      "message": "Prop spreading can pass unexpected props and bypasses type checking",
      "suggestion": "Explicitly destructure and pass needed props, or ensure proper TypeScript types",
      "severity": "info",
      "documentationUrl": "https://react.dev/learn/passing-props-to-a-component",
      "agentId": "sme-react"
    },
    {
      "id": "react-useeffect-no-cleanup",
      "name": "useEffect Without Cleanup",
      "category": "memory",
      "pattern": "useEffect\\s*\\(\\s*(?:async\\s*)?\\(\\)\\s*=>\\s*\\{[^}]*(?:addEventListener|setInterval|setTimeout|subscribe)[^}]*\\}\\s*,",
      "message": "Effects with subscriptions/timers need cleanup to prevent memory leaks",
      "suggestion": "Return a cleanup function from useEffect to remove listeners/clear timers",
      "severity": "warning",
      "documentationUrl": "https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development",
      "agentId": "sme-react"
    },
    {
      "id": "react-async-useeffect",
      "name": "Async useEffect Function",
      "category": "patterns",
      "pattern": "useEffect\\s*\\(\\s*async\\s*\\(",
      "message": "useEffect callback cannot be async directly (returns Promise instead of cleanup)",
      "suggestion": "Define async function inside useEffect and call it immediately",
      "severity": "error",
      "documentationUrl": "https://react.dev/reference/react/useEffect#fetching-data-with-effects",
      "agentId": "sme-react"
    },
    {
      "id": "react-dangerouslysetinnerhtml",
      "name": "dangerouslySetInnerHTML Usage",
      "category": "security",
      "pattern": "dangerouslySetInnerHTML\\s*=\\s*\\{\\s*\\{\\s*__html:",
      "message": "dangerouslySetInnerHTML can expose XSS vulnerabilities",
      "suggestion": "Sanitize HTML with DOMPurify before rendering, or use React elements",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/react-dom/components/common#dangerously-setting-the-inner-html",
      "agentId": "sme-react"
    },
    {
      "id": "react-onclick-no-keyboard",
      "name": "onClick Without Keyboard Handler",
      "category": "accessibility",
      "pattern": "<(?:div|span|p)\\s+[^>]*onClick\\s*=\\s*\\{[^}]+\\}(?![^>]*(?:onKeyDown|onKeyPress|onKeyUp|tabIndex))",
      "message": "Click handlers on non-interactive elements need keyboard support for accessibility",
      "suggestion": "Add onKeyDown handler and tabIndex=\"0\", or use a <button> element",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/react-dom/components#common-props",
      "agentId": "sme-react"
    },
    {
      "id": "react-img-no-alt",
      "name": "Image Without Alt Text",
      "category": "accessibility",
      "pattern": "<img\\s+(?![^>]*\\balt\\s*=)",
      "message": "Images must have alt text for screen readers",
      "suggestion": "Add alt=\"description\" or alt=\"\" for decorative images",
      "severity": "warning",
      "documentationUrl": "https://react.dev/reference/react-dom/components/common#common-props",
      "agentId": "sme-react"
    },
    {
      "id": "vue-reactive-destructure",
      "name": "Destructuring Reactive Object",
      "category": "reactivity",
      "pattern": "(?:const|let)\\s*\\{[^}]+\\}\\s*=\\s*(?:reactive|props)",
      "message": "Destructuring reactive objects loses reactivity",
      "suggestion": "Use toRefs() to maintain reactivity: const { prop } = toRefs(reactive)",
      "severity": "error",
      "documentationUrl": "https://vuejs.org/guide/essentials/reactivity-fundamentals.html#limitations-of-reactive",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-ref-no-value",
      "name": "Accessing Ref Without .value",
      "category": "reactivity",
      "pattern": "ref\\([^)]+\\)[^.]*[+\\-*\\/=<>!]",
      "message": "Ref objects need .value to access the inner value in JavaScript",
      "suggestion": "Use .value to access ref value: myRef.value",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/guide/essentials/reactivity-fundamentals.html#ref",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-reactive-reassign",
      "name": "Reassigning Reactive Object",
      "category": "reactivity",
      "pattern": "(?:const|let)\\s+(\\w+)\\s*=\\s*reactive\\([^)]+\\)[^;]*;[^]*\\1\\s*=",
      "message": "Reassigning a reactive object breaks reactivity",
      "suggestion": "Use Object.assign() or replace properties individually",
      "severity": "error",
      "documentationUrl": "https://vuejs.org/guide/essentials/reactivity-fundamentals.html#limitations-of-reactive",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-setup-no-return",
      "name": "Setup Without Return",
      "category": "composition",
      "pattern": "setup\\s*\\([^)]*\\)\\s*\\{(?![^}]*return\\s*\\{)",
      "message": "Setup function should return reactive state and methods for template",
      "suggestion": "Return an object with all reactive state and methods needed in template",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/api/composition-api-setup.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-async-setup",
      "name": "Async Setup Without Suspense",
      "category": "composition",
      "pattern": "async\\s+setup\\s*\\(",
      "message": "Async setup requires parent Suspense component",
      "suggestion": "Wrap parent component with <Suspense> or move async logic to onMounted",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/guide/built-ins/suspense.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-onmounted-await",
      "name": "Await After onMounted",
      "category": "lifecycle",
      "pattern": "onMounted\\s*\\([^)]*\\)\\s*[;]?\\s*await",
      "message": "Await after onMounted may execute after component is mounted",
      "suggestion": "Put async logic inside onMounted callback or use watchEffect",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/api/composition-api-lifecycle.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-watch-immediate",
      "name": "Watch Without Immediate for Initial Value",
      "category": "lifecycle",
      "pattern": "watch\\s*\\([^,]+,\\s*(?:async\\s*)?\\([^)]*\\)\\s*=>\\s*\\{[^}]*fetch|api|axios",
      "message": "Watch callbacks for data fetching often need immediate: true",
      "suggestion": "Add { immediate: true } to run on initial value",
      "severity": "info",
      "documentationUrl": "https://vuejs.org/guide/essentials/watchers.html#eager-watchers",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-v-if-v-for",
      "name": "v-if with v-for on Same Element",
      "category": "performance",
      "pattern": "v-for\\s*=\\s*\"[^\"]*\"\\s+v-if\\s*=|v-if\\s*=\\s*\"[^\"]*\"\\s+v-for\\s*=",
      "message": "Using v-if and v-for on the same element is not recommended",
      "suggestion": "Move v-if to a wrapper element or use computed property to filter",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/style-guide/rules-essential.html#avoid-v-if-with-v-for",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-missing-key",
      "name": "v-for Without Key",
      "category": "performance",
      "pattern": "v-for\\s*=\\s*\"[^\"]*\"(?![^>]*:key)",
      "message": "v-for should always include a :key binding for efficient updates",
      "suggestion": "Add :key with a unique identifier from your data",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/style-guide/rules-essential.html#use-keyed-v-for",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-index-key",
      "name": "Array Index as v-for Key",
      "category": "performance",
      "pattern": "v-for\\s*=\\s*\"\\s*\\([^,]+,\\s*(?:index|i|idx)\\)[^\"]*\"\\s+:key\\s*=\\s*\"(?:index|i|idx)\"",
      "message": "Using index as key can cause issues with list reordering",
      "suggestion": "Use a unique identifier from your data as the key",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/guide/essentials/list.html#maintaining-state-with-key",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-mutate-prop",
      "name": "Mutating Props",
      "category": "props",
      "pattern": "props\\.\\w+\\s*=",
      "message": "Props should not be mutated directly - use emits or local data",
      "suggestion": "Emit an event to parent or copy prop to local ref",
      "severity": "error",
      "documentationUrl": "https://vuejs.org/guide/components/props.html#one-way-data-flow",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-emit-update",
      "name": "v-model Without Update Emit",
      "category": "props",
      "pattern": "defineProps.*modelValue[^}]*\\}(?![^]*emit.*update:modelValue)",
      "message": "v-model requires emitting update:modelValue event",
      "suggestion": "Emit update:modelValue when the value changes",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/guide/components/v-model.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-template-expression",
      "name": "Complex Template Expression",
      "category": "templates",
      "pattern": "\\{\\{\\s*[^}]+(?:\\.filter|\\.map|\\.reduce|&&.*&&|if.*else)[^}]*\\}\\}",
      "message": "Complex expressions in templates should be computed properties",
      "suggestion": "Extract to a computed property for readability and caching",
      "severity": "info",
      "documentationUrl": "https://vuejs.org/guide/essentials/computed.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-unused-computed",
      "name": "Computed Property Without Dependencies",
      "category": "reactivity",
      "pattern": "computed\\s*\\(\\s*\\(\\)\\s*=>\\s*(?:true|false|\\d+|['\"][^'\"]*['\"])\\s*\\)",
      "message": "Computed property returning constant should be a plain value",
      "suggestion": "Use a const or ref instead of computed for static values",
      "severity": "info",
      "documentationUrl": "https://vuejs.org/guide/essentials/computed.html",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-this-in-arrow",
      "name": "Arrow Function in Options API",
      "category": "options",
      "pattern": "(?:methods|computed|watch)\\s*:\\s*\\{[^}]*:\\s*\\([^)]*\\)\\s*=>",
      "message": "Arrow functions in Options API lose access to this",
      "suggestion": "Use regular functions in methods/computed/watch options",
      "severity": "error",
      "documentationUrl": "https://vuejs.org/guide/essentials/reactivity-fundamentals.html#stateful-methods",
      "agentId": "sme-vue"
    },
    {
      "id": "vue-v-html",
      "name": "v-html with Dynamic Content",
      "category": "security",
      "pattern": "v-html\\s*=\\s*\"[^\"]*\"",
      "message": "v-html can expose XSS vulnerabilities with user content",
      "suggestion": "Sanitize content with DOMPurify or use text interpolation",
      "severity": "warning",
      "documentationUrl": "https://vuejs.org/api/built-in-directives.html#v-html",
      "agentId": "sme-vue"
    },
    {
      "id": "nextjs-use-client-hooks",
      "name": "Hooks in Server Component",
      "category": "rsc",
      "pattern": "(?<!['\"]use client['\"][^]*)(useState|useEffect|useContext|useReducer|useCallback|useMemo)\\s*\\(",
      "message": "React hooks can only be used in Client Components",
      "suggestion": "Add \"use client\" directive at the top of the file",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/getting-started/react-essentials#client-components",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-use-client-event",
      "name": "Event Handler in Server Component",
      "category": "rsc",
      "pattern": "(?<!['\"]use client['\"][^]*)<\\w+[^>]*\\son(?:Click|Change|Submit|Focus|Blur)\\s*=",
      "message": "Event handlers require Client Components",
      "suggestion": "Add \"use client\" or extract interactive parts to a Client Component",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/getting-started/react-essentials#client-components",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-async-client",
      "name": "Async Client Component",
      "category": "rsc",
      "pattern": "['\"]use client['\"][^]*export\\s+(?:default\\s+)?async\\s+function",
      "message": "Client Components cannot be async - use useEffect for data fetching",
      "suggestion": "Remove async or convert to Server Component",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/getting-started/react-essentials",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-fetch-no-cache",
      "name": "Fetch Without Cache Option",
      "category": "data-fetching",
      "pattern": "fetch\\s*\\(\\s*['\"][^'\"]+['\"]\\s*\\)(?!\\s*\\.)",
      "message": "Consider specifying cache behavior for fetch in Server Components",
      "suggestion": "Add cache option: fetch(url, { cache: \"force-cache\" | \"no-store\" })",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-use-swr-server",
      "name": "useSWR in Server Component",
      "category": "data-fetching",
      "pattern": "(?<!['\"]use client['\"][^]*)useSWR\\s*\\(",
      "message": "useSWR is for Client Components - use native fetch in Server Components",
      "suggestion": "Use fetch() directly in Server Components or add \"use client\"",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/data-fetching",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-getserversideprops-app",
      "name": "getServerSideProps in App Router",
      "category": "data-fetching",
      "pattern": "export\\s+(?:async\\s+)?function\\s+getServerSideProps",
      "message": "getServerSideProps is Pages Router - use async Server Components in App Router",
      "suggestion": "Convert to async Server Component with direct fetch",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-link-no-prefetch",
      "name": "Link Prefetch Disabled Unnecessarily",
      "category": "routing",
      "pattern": "<Link[^>]*prefetch\\s*=\\s*\\{?\\s*false\\s*\\}?",
      "message": "Disabling prefetch hurts navigation performance",
      "suggestion": "Only disable prefetch for rarely visited links",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/components/link#prefetch",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-router-push-soft",
      "name": "router.push Without Scroll Reset",
      "category": "routing",
      "pattern": "router\\.push\\s*\\([^)]+\\)(?![^}]*scroll\\s*:)",
      "message": "Consider scroll behavior for navigation",
      "suggestion": "Add { scroll: false } if you want to preserve scroll position",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/functions/use-router",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-a-tag-internal",
      "name": "Anchor Tag for Internal Link",
      "category": "routing",
      "pattern": "<a\\s+href\\s*=\\s*['\"]\\/[^'\"]*['\"]",
      "message": "Use next/link for internal navigation to enable client-side routing",
      "suggestion": "Replace <a> with <Link> from next/link",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/components/link",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-img-tag",
      "name": "Native img Tag",
      "category": "images",
      "pattern": "<img\\s+src\\s*=",
      "message": "Use next/image for automatic image optimization",
      "suggestion": "Replace <img> with <Image> from next/image",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/components/image",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-image-no-size",
      "name": "Next Image Without Dimensions",
      "category": "images",
      "pattern": "<Image[^>]*(?:src\\s*=)[^>]*(?!width|height|fill)[^>]*\\/>",
      "message": "Next Image requires width/height or fill property",
      "suggestion": "Add width and height props, or use fill with relative parent",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/components/image#required-props",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-image-priority",
      "name": "LCP Image Without Priority",
      "category": "images",
      "pattern": "<Image[^>]*(?:hero|banner|main|cover)[^>]*(?!priority)",
      "message": "Large images above the fold should have priority prop",
      "suggestion": "Add priority prop for LCP images",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/api-reference/components/image#priority",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-server-action-export",
      "name": "Server Action Without \"use server\"",
      "category": "server-actions",
      "pattern": "export\\s+async\\s+function\\s+\\w+\\s*\\([^)]*formData",
      "message": "Server Actions need \"use server\" directive",
      "suggestion": "Add \"use server\" at top of file or inside the function",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-formaction-client",
      "name": "Form Action in Client Component",
      "category": "server-actions",
      "pattern": "['\"]use client['\"][^]*<form[^>]*action\\s*=\\s*\\{",
      "message": "Form actions with Server Actions need careful handling in Client Components",
      "suggestion": "Import Server Action from a separate file with \"use server\"",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions#client-components",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-head-component",
      "name": "Using next/head in App Router",
      "category": "metadata",
      "pattern": "import\\s+Head\\s+from\\s+['\"]next\\/head['\"]",
      "message": "next/head is for Pages Router - use Metadata API in App Router",
      "suggestion": "Export metadata object or generateMetadata function",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/optimizing/metadata",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-metadata-client",
      "name": "Metadata in Client Component",
      "category": "metadata",
      "pattern": "['\"]use client['\"][^]*export\\s+(?:const\\s+metadata|async\\s+function\\s+generateMetadata)",
      "message": "Metadata can only be exported from Server Components",
      "suggestion": "Move metadata to a Server Component (parent layout or page)",
      "severity": "error",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/optimizing/metadata",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-dynamic-import",
      "name": "Large Client Component Without Dynamic Import",
      "category": "performance",
      "pattern": "['\"]use client['\"][^]*import\\s+\\{[^}]{100,}\\}",
      "message": "Large Client Components should use dynamic imports",
      "suggestion": "Use next/dynamic for code splitting: dynamic(() => import(\"./Component\"))",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/optimizing/lazy-loading",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-suspense-missing",
      "name": "Async Component Without Suspense",
      "category": "performance",
      "pattern": "export\\s+default\\s+async\\s+function\\s+\\w+[^{]*\\{[^}]*await[^}]*\\}(?![^}]*<Suspense)",
      "message": "Async Server Components should be wrapped in Suspense",
      "suggestion": "Wrap slow async components in <Suspense fallback={...}>",
      "severity": "info",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming",
      "agentId": "sme-nextjs"
    },
    {
      "id": "nextjs-middleware-heavy",
      "name": "Heavy Operation in Middleware",
      "category": "middleware",
      "pattern": "export\\s+(?:async\\s+)?function\\s+middleware[^{]*\\{[^}]*(?:fetch|database|prisma|mongoose)",
      "message": "Middleware runs on every request - avoid heavy operations",
      "suggestion": "Move heavy logic to API routes or Server Components",
      "severity": "warning",
      "documentationUrl": "https://nextjs.org/docs/app/building-your-application/routing/middleware",
      "agentId": "sme-nextjs"
    },
    {
      "id": "django-n-plus-1",
      "name": "Potential N+1 Query",
      "category": "orm",
      "pattern": "for\\s+\\w+\\s+in\\s+\\w+\\.objects\\.(?:all|filter)[^:]*:[^}]*\\.\\w+_set\\.",
      "message": "Accessing related objects in a loop causes N+1 queries",
      "suggestion": "Use select_related() or prefetch_related() to optimize",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#select-related",
      "agentId": "sme-django"
    },
    {
      "id": "django-all-in-loop",
      "name": "QuerySet.all() in Loop",
      "category": "orm",
      "pattern": "for\\s+\\w+\\s+in\\s+\\w+\\.objects\\.all\\(\\)",
      "message": "Iterating over all() in a loop may load entire table into memory",
      "suggestion": "Use iterator() for large querysets: Model.objects.all().iterator()",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#iterator",
      "agentId": "sme-django"
    },
    {
      "id": "django-count-vs-exists",
      "name": "Using count() for Existence Check",
      "category": "orm",
      "pattern": "\\.objects\\.(?:filter|all)\\([^)]*\\)\\.count\\(\\)\\s*(?:>|!=|==)\\s*0",
      "message": "Using count() > 0 is slower than exists() for existence checks",
      "suggestion": "Use .exists() instead of .count() > 0",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#exists",
      "agentId": "sme-django"
    },
    {
      "id": "django-len-queryset",
      "name": "len() on QuerySet",
      "category": "orm",
      "pattern": "len\\(\\s*\\w+\\.objects\\.",
      "message": "len() on QuerySet fetches all objects - use .count() instead",
      "suggestion": "Use .count() for counting, it uses SQL COUNT",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#count",
      "agentId": "sme-django"
    },
    {
      "id": "django-values-list-flat",
      "name": "values_list Without flat",
      "category": "orm",
      "pattern": "\\.values_list\\(\\s*['\"][^'\"]+['\"]\\s*\\)(?!\\.)",
      "message": "Single field values_list returns tuples - use flat=True for list",
      "suggestion": "Add flat=True: .values_list(\"field\", flat=True)",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#values-list",
      "agentId": "sme-django"
    },
    {
      "id": "django-get-or-none",
      "name": "Try/Except for DoesNotExist",
      "category": "orm",
      "pattern": "try:[^}]*\\.objects\\.get\\([^)]+\\)[^}]*except\\s+\\w+\\.DoesNotExist",
      "message": "Consider using filter().first() instead of try/except with get()",
      "suggestion": "Use .filter(...).first() which returns None if not found",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#first",
      "agentId": "sme-django"
    },
    {
      "id": "django-business-logic-view",
      "name": "Business Logic in View",
      "category": "views",
      "pattern": "def\\s+\\w+\\(request[^)]*\\):[^}]{500,}",
      "message": "Long view functions may indicate business logic that should be in services",
      "suggestion": "Extract business logic to service layer or model methods",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/misc/design-philosophies/",
      "agentId": "sme-django"
    },
    {
      "id": "django-manual-json",
      "name": "Manual JSON Response",
      "category": "views",
      "pattern": "HttpResponse\\([^)]*json\\.dumps",
      "message": "Use JsonResponse instead of manual JSON serialization",
      "suggestion": "Replace with JsonResponse(data) for proper content-type and encoding",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/request-response/#jsonresponse-objects",
      "agentId": "sme-django"
    },
    {
      "id": "django-missing-login-required",
      "name": "View Without Authentication Check",
      "category": "views",
      "pattern": "def\\s+\\w+\\(request[^)]*\\):[^}]*\\.objects\\.[^}]*(?:create|update|delete|save)",
      "message": "View modifying data may need authentication check",
      "suggestion": "Add @login_required decorator or check request.user.is_authenticated",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/topics/auth/default/#the-login-required-decorator",
      "agentId": "sme-django"
    },
    {
      "id": "django-raw-sql",
      "name": "Raw SQL Query",
      "category": "security",
      "pattern": "\\.raw\\s*\\(\\s*[f'\"]|\\.execute\\s*\\(\\s*[f'\"]",
      "message": "Raw SQL with string formatting is vulnerable to SQL injection",
      "suggestion": "Use parameterized queries: cursor.execute(sql, [params])",
      "severity": "error",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/topics/security/#sql-injection-protection",
      "agentId": "sme-django"
    },
    {
      "id": "django-extra-raw",
      "name": "QuerySet extra() Method",
      "category": "security",
      "pattern": "\\.extra\\s*\\(",
      "message": "extra() is deprecated and can lead to SQL injection",
      "suggestion": "Use annotate(), F() expressions, or RawSQL with params",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/querysets/#extra",
      "agentId": "sme-django"
    },
    {
      "id": "django-csrf-exempt",
      "name": "CSRF Exempt Decorator",
      "category": "security",
      "pattern": "@csrf_exempt",
      "message": "CSRF exemption removes protection against cross-site request forgery",
      "suggestion": "Only use for APIs with token auth - ensure other protection exists",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/csrf/",
      "agentId": "sme-django"
    },
    {
      "id": "django-unsafe-redirect",
      "name": "Unsafe Redirect",
      "category": "security",
      "pattern": "redirect\\s*\\(\\s*request\\.(GET|POST)\\.get\\s*\\(",
      "message": "Redirect using user input can lead to open redirect vulnerability",
      "suggestion": "Validate redirect URL against allowed hosts",
      "severity": "error",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/topics/security/#user-uploaded-content-security",
      "agentId": "sme-django"
    },
    {
      "id": "django-mark-safe",
      "name": "mark_safe Usage",
      "category": "security",
      "pattern": "mark_safe\\s*\\(",
      "message": "mark_safe bypasses HTML escaping - ensure content is sanitized",
      "suggestion": "Verify content is safe or use format_html() for dynamic content",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/utils/#django.utils.html.format_html",
      "agentId": "sme-django"
    },
    {
      "id": "django-nullable-string",
      "name": "Nullable String Field",
      "category": "models",
      "pattern": "(?:CharField|TextField)\\s*\\([^)]*null\\s*=\\s*True",
      "message": "String fields with null=True have two empty states (null and \"\")",
      "suggestion": "Use blank=True instead of null=True for string fields",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/fields/#null",
      "agentId": "sme-django"
    },
    {
      "id": "django-missing-str",
      "name": "Model Without __str__",
      "category": "models",
      "pattern": "class\\s+\\w+\\(models\\.Model\\):[^}]*(?!def\\s+__str__)",
      "message": "Model without __str__ shows unhelpful representation in admin",
      "suggestion": "Add __str__ method to return meaningful representation",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/instances/#str",
      "agentId": "sme-django"
    },
    {
      "id": "django-missing-meta",
      "name": "Model Without Meta Class",
      "category": "models",
      "pattern": "class\\s+\\w+\\(models\\.Model\\):[^}]*(?!class\\s+Meta)",
      "message": "Consider adding Meta class for ordering and other options",
      "suggestion": "Add class Meta with ordering, verbose_name, etc.",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/options/",
      "agentId": "sme-django"
    },
    {
      "id": "django-cascade-delete",
      "name": "ForeignKey Without on_delete",
      "category": "models",
      "pattern": "ForeignKey\\s*\\([^)]*(?!on_delete)",
      "message": "ForeignKey requires on_delete argument in Django 2.0+",
      "suggestion": "Add on_delete=models.CASCADE, PROTECT, SET_NULL, etc.",
      "severity": "error",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/models/fields/#django.db.models.ForeignKey.on_delete",
      "agentId": "sme-django"
    },
    {
      "id": "django-runpython-atomic",
      "name": "RunPython Without Atomic",
      "category": "migrations",
      "pattern": "migrations\\.RunPython\\s*\\([^)]*(?!atomic)",
      "message": "RunPython operations should specify atomic behavior",
      "suggestion": "Add atomic=True/False based on whether operation is reversible",
      "severity": "info",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/migration-operations/#runpython",
      "agentId": "sme-django"
    },
    {
      "id": "django-debug-true",
      "name": "DEBUG=True in Settings",
      "category": "settings",
      "pattern": "DEBUG\\s*=\\s*True",
      "message": "DEBUG should be False in production",
      "suggestion": "Use environment variable: DEBUG = os.getenv(\"DEBUG\", \"False\") == \"True\"",
      "severity": "warning",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/settings/#debug",
      "agentId": "sme-django"
    },
    {
      "id": "django-secret-key-hardcoded",
      "name": "Hardcoded SECRET_KEY",
      "category": "settings",
      "pattern": "SECRET_KEY\\s*=\\s*['\"]",
      "message": "SECRET_KEY should not be hardcoded in settings",
      "suggestion": "Use environment variable: SECRET_KEY = os.getenv(\"SECRET_KEY\")",
      "severity": "error",
      "documentationUrl": "https://docs.djangoproject.com/en/stable/ref/settings/#secret-key",
      "agentId": "sme-django"
    },
    {
      "id": "rails-n-plus-1",
      "name": "Potential N+1 Query",
      "category": "activerecord",
      "pattern": "\\.each\\s+do\\s+\\|[^|]+\\|[^}]*\\.\\w+s(?:\\.|\\s)",
      "message": "Accessing associations in a loop causes N+1 queries",
      "suggestion": "Use includes(:association) or preload() to eager load",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-all-each",
      "name": "Model.all.each",
      "category": "activerecord",
      "pattern": "\\.\\s*all\\s*\\.each\\s+do",
      "message": "all.each loads entire table into memory",
      "suggestion": "Use find_each for large datasets: Model.find_each { |record| }",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects-in-batches",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-where-first",
      "name": "where().first Instead of find_by",
      "category": "activerecord",
      "pattern": "\\.where\\([^)]+\\)\\.first(?!\\s*!)",
      "message": "where().first is less efficient than find_by",
      "suggestion": "Use find_by for single record lookups",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#find-by",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-count-vs-exists",
      "name": "count for Existence Check",
      "category": "activerecord",
      "pattern": "\\.count\\s*(?:>|!=|==)\\s*0",
      "message": "Using count for existence check is slower than exists?",
      "suggestion": "Use .exists? instead of .count > 0",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#existence-of-objects",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-pluck-ids",
      "name": "map(&:id) Instead of pluck",
      "category": "activerecord",
      "pattern": "\\.map\\s*\\(&:id\\)",
      "message": "map(&:id) loads full objects - use pluck for single columns",
      "suggestion": "Use .pluck(:id) for better performance",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#pluck",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-update-all",
      "name": "each with update",
      "category": "activerecord",
      "pattern": "\\.each\\s+do\\s+\\|[^|]+\\|[^}]*\\.update\\s*\\(",
      "message": "Updating records in a loop creates multiple queries",
      "suggestion": "Use update_all for bulk updates when possible",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#update-all",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-save-bang",
      "name": "save Without Bang",
      "category": "activerecord",
      "pattern": "\\.save(?!\\s*!|\\s*\\(validate:)",
      "message": "save returns false on failure - use save! or handle return value",
      "suggestion": "Use save! to raise on failure, or check return value",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_validations.html#valid-questionmark-and-invalid-questionmark",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-fat-controller",
      "name": "Fat Controller",
      "category": "controllers",
      "pattern": "def\\s+(?:create|update)\\s*\\n(?:[^\\n]*\\n){15,}",
      "message": "Long controller actions indicate logic that should be extracted",
      "suggestion": "Extract business logic to service objects or model methods",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/action_controller_overview.html",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-render-and-return",
      "name": "render Without Return",
      "category": "controllers",
      "pattern": "render[^;]*\\n(?!.*return|.*and return)",
      "message": "render does not stop execution - add \"and return\" or explicit return",
      "suggestion": "Use \"render ... and return\" or \"return render ...\"",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/layouts_and_rendering.html#avoiding-double-render-errors",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-instance-var-view",
      "name": "Too Many Instance Variables",
      "category": "controllers",
      "pattern": "def\\s+\\w+\\s*\\n(?:[^@]*@\\w+\\s*=[^@]*){5,}",
      "message": "Many instance variables may indicate need for presenter/view model",
      "suggestion": "Consider using a presenter or form object to encapsulate view data",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/action_controller_overview.html",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-sql-injection",
      "name": "Raw SQL String",
      "category": "security",
      "pattern": "\\.where\\s*\\(\\s*[\"'].*#\\{",
      "message": "String interpolation in where clause is vulnerable to SQL injection",
      "suggestion": "Use parameterized queries: where(\"column = ?\", value)",
      "severity": "error",
      "documentationUrl": "https://guides.rubyonrails.org/security.html#sql-injection",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-find-by-sql",
      "name": "find_by_sql with Interpolation",
      "category": "security",
      "pattern": "find_by_sql\\s*\\(\\s*[\"'].*#\\{",
      "message": "SQL injection vulnerability in find_by_sql",
      "suggestion": "Use sanitize_sql or array syntax for parameters",
      "severity": "error",
      "documentationUrl": "https://guides.rubyonrails.org/security.html#sql-injection",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-mass-assignment",
      "name": "params Without permit",
      "category": "security",
      "pattern": "\\.(?:create|update|new)\\s*\\(\\s*params\\s*\\)",
      "message": "Mass assignment vulnerability - params must be permitted",
      "suggestion": "Use strong parameters: params.require(:model).permit(:field1, :field2)",
      "severity": "error",
      "documentationUrl": "https://guides.rubyonrails.org/action_controller_overview.html#strong-parameters",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-html-safe",
      "name": "html_safe Usage",
      "category": "security",
      "pattern": "\\.html_safe",
      "message": "html_safe bypasses XSS protection - ensure content is sanitized",
      "suggestion": "Use sanitize helper or ensure content is safe",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/security.html#cross-site-scripting-xss",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-send-file",
      "name": "send_file with User Input",
      "category": "security",
      "pattern": "send_file\\s*\\(\\s*params",
      "message": "send_file with user input can expose sensitive files",
      "suggestion": "Validate file path against allowed directory",
      "severity": "error",
      "documentationUrl": "https://guides.rubyonrails.org/security.html#file-uploads",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-callback-conditional",
      "name": "Complex Callback Conditions",
      "category": "models",
      "pattern": "(?:before|after|around)_\\w+\\s+:\\w+,\\s*if:\\s*->",
      "message": "Complex callback conditions may indicate logic that should be explicit",
      "suggestion": "Consider making callback unconditional or moving logic to service",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_callbacks.html",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-skip-validation",
      "name": "Skipping Validations",
      "category": "models",
      "pattern": "(?:save|update)\\s*\\(\\s*validate:\\s*false\\s*\\)",
      "message": "Skipping validations can lead to invalid data in database",
      "suggestion": "Only skip validations when absolutely necessary and document why",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_validations.html#skipping-validations",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-default-scope",
      "name": "default_scope Usage",
      "category": "models",
      "pattern": "default_scope\\s+",
      "message": "default_scope can cause unexpected behavior and is hard to override",
      "suggestion": "Use explicit scopes instead of default_scope",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#applying-a-default-scope",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-match-route",
      "name": "match Route Without via",
      "category": "routing",
      "pattern": "match\\s+['\"][^'\"]+['\"](?![^,]*via:)",
      "message": "match routes should specify HTTP methods for security",
      "suggestion": "Add via: option or use specific method routes (get, post, etc.)",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/routing.html#http-verb-constraints",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-query-in-view",
      "name": "Database Query in View",
      "category": "views",
      "pattern": "<%[^%]*\\.(?:where|find|all|first|last)\\s*[(%]",
      "message": "Database queries in views violate MVC and can cause N+1",
      "suggestion": "Move queries to controller and pass data via instance variables",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/layouts_and_rendering.html",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-helper-logic",
      "name": "Complex Logic in View",
      "category": "views",
      "pattern": "<%[^%]*(?:if|unless|case)[^%]*%>(?:[^%]*<%[^%]*(?:if|unless|case))",
      "message": "Nested conditionals in views should be extracted to helpers or presenters",
      "suggestion": "Extract complex logic to helper methods or presenter objects",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/action_view_helpers.html",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-transaction-scope",
      "name": "Transaction Without Proper Scope",
      "category": "services",
      "pattern": "ActiveRecord::Base\\.transaction\\s+do\\s*\\n(?:[^\\n]*\\n){20,}",
      "message": "Long transactions can cause database locking issues",
      "suggestion": "Keep transactions as short as possible, move non-DB work outside",
      "severity": "warning",
      "documentationUrl": "https://guides.rubyonrails.org/active_record_querying.html#transactions",
      "agentId": "sme-rails"
    },
    {
      "id": "rails-fixture-over-factory",
      "name": "Fixtures in Tests",
      "category": "testing",
      "pattern": "fixtures\\s+:",
      "message": "Consider using factories (FactoryBot) for more maintainable tests",
      "suggestion": "Factories provide better control and documentation of test data",
      "severity": "info",
      "documentationUrl": "https://guides.rubyonrails.org/testing.html#the-low-down-on-fixtures",
      "agentId": "sme-rails"
    },
    {
      "id": "security-hardcoded-password",
      "name": "Hardcoded Password",
      "category": "secrets",
      "pattern": "(?:password|passwd|pwd)\\s*[:=]\\s*['\"][^'\"]{4,}['\"]",
      "message": "Hardcoded password detected - credentials should never be in source code",
      "suggestion": "Use environment variables or a secrets manager (AWS Secrets Manager, HashiCorp Vault)",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-hardcoded-api-key",
      "name": "Hardcoded API Key",
      "category": "secrets",
      "pattern": "(?:api[_-]?key|apikey|api[_-]?secret)\\s*[:=]\\s*['\"][^'\"]{8,}['\"]",
      "message": "Hardcoded API key detected - keys should be externalized",
      "suggestion": "Store API keys in environment variables or a secrets manager",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-hardcoded-token",
      "name": "Hardcoded Token",
      "category": "secrets",
      "pattern": "(?:access[_-]?token|auth[_-]?token|bearer[_-]?token|jwt[_-]?secret)\\s*[:=]\\s*['\"][^'\"]{10,}['\"]",
      "message": "Hardcoded token detected - tokens should never be committed",
      "suggestion": "Use environment variables and add to .gitignore",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-private-key-inline",
      "name": "Private Key in Code",
      "category": "secrets",
      "pattern": "-----BEGIN\\s+(?:RSA\\s+)?PRIVATE\\s+KEY-----",
      "message": "Private key embedded in source code",
      "suggestion": "Store private keys in secure files outside of source control",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Key_Management_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-aws-credentials",
      "name": "AWS Credentials in Code",
      "category": "secrets",
      "pattern": "(?:AKIA|ABIA|ACCA|ASIA)[A-Z0-9]{16}",
      "message": "AWS access key ID detected in source code",
      "suggestion": "Use IAM roles, AWS Secrets Manager, or environment variables",
      "severity": "error",
      "documentationUrl": "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-sql-string-concat",
      "name": "SQL String Concatenation",
      "category": "injection",
      "pattern": "(?:execute|query|raw)\\s*\\(\\s*['\"`].*\\s*\\+\\s*\\w+|['\"`].*\\$\\{",
      "message": "SQL query built with string concatenation - potential SQL injection",
      "suggestion": "Use parameterized queries or prepared statements",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-command-injection",
      "name": "Command Injection Risk",
      "category": "injection",
      "pattern": "(?:exec|spawn|system|popen|shell_exec)\\s*\\([^)]*\\$|(?:exec|spawn|system)\\s*\\(`[^`]*\\$\\{",
      "message": "Shell command with dynamic input - potential command injection",
      "suggestion": "Validate and sanitize input, use allowlists, avoid shell when possible",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-eval-usage",
      "name": "Eval Usage",
      "category": "injection",
      "pattern": "\\beval\\s*\\(",
      "message": "eval() executes arbitrary code - high security risk",
      "suggestion": "Use safer alternatives like JSON.parse() or specific parsers",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-new-function",
      "name": "Dynamic Function Constructor",
      "category": "injection",
      "pattern": "new\\s+Function\\s*\\(",
      "message": "new Function() is similar to eval() - executes arbitrary code",
      "suggestion": "Avoid dynamic code execution, use safer patterns",
      "severity": "error",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/Function",
      "agentId": "sme-security"
    },
    {
      "id": "security-innerHTML",
      "name": "innerHTML XSS Risk",
      "category": "injection",
      "pattern": "\\.innerHTML\\s*=|\\.outerHTML\\s*=",
      "message": "innerHTML can execute scripts - XSS vulnerability",
      "suggestion": "Use textContent, or sanitize with DOMPurify",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-document-write",
      "name": "document.write XSS",
      "category": "injection",
      "pattern": "document\\.write\\s*\\(",
      "message": "document.write() can introduce XSS vulnerabilities",
      "suggestion": "Use DOM manipulation methods instead",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-weak-password-regex",
      "name": "Weak Password Validation",
      "category": "authentication",
      "pattern": "password.*\\.length\\s*(?:>=?|>)\\s*[1-5]\\b",
      "message": "Password minimum length is too short",
      "suggestion": "Require at least 8 characters, preferably 12+",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#implement-proper-password-strength-controls",
      "agentId": "sme-security"
    },
    {
      "id": "security-plaintext-password-storage",
      "name": "Plaintext Password Storage",
      "category": "authentication",
      "pattern": "(?:user|account)\\.password\\s*=\\s*(?:req|request|params)",
      "message": "Password may be stored without hashing",
      "suggestion": "Always hash passwords with bcrypt, Argon2, or PBKDF2",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-jwt-none-algorithm",
      "name": "JWT None Algorithm",
      "category": "authentication",
      "pattern": "algorithm['\":\\s]+['\"]?none['\"]?",
      "message": "JWT \"none\" algorithm disables signature verification",
      "suggestion": "Always use a secure algorithm like RS256 or HS256",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-session-fixation",
      "name": "Missing Session Regeneration",
      "category": "authentication",
      "pattern": "(?:login|authenticate|sign_in).*\\{[^}]*(?!regenerate|rotate|new_session)",
      "message": "Session may not be regenerated after authentication",
      "suggestion": "Regenerate session ID after successful login to prevent fixation",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#renew-the-session-id-after-any-privilege-level-change",
      "agentId": "sme-security"
    },
    {
      "id": "security-weak-hash-md5",
      "name": "Weak Hash Algorithm (MD5)",
      "category": "cryptography",
      "pattern": "\\b(?:md5|MD5)\\s*\\(",
      "message": "MD5 is cryptographically broken - do not use for security",
      "suggestion": "Use SHA-256 or SHA-3 for hashing, bcrypt/Argon2 for passwords",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-weak-hash-sha1",
      "name": "Weak Hash Algorithm (SHA1)",
      "category": "cryptography",
      "pattern": "\\b(?:sha1|SHA1)\\s*\\(",
      "message": "SHA1 is deprecated for security purposes",
      "suggestion": "Use SHA-256 or SHA-3 instead",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-weak-random",
      "name": "Insecure Random Number",
      "category": "cryptography",
      "pattern": "Math\\.random\\s*\\(\\s*\\).*(?:token|key|secret|password|salt|nonce)",
      "message": "Math.random() is not cryptographically secure",
      "suggestion": "Use crypto.randomBytes() or crypto.getRandomValues()",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation",
      "agentId": "sme-security"
    },
    {
      "id": "security-ecb-mode",
      "name": "ECB Cipher Mode",
      "category": "cryptography",
      "pattern": "['\"]ECB['\"]",
      "message": "ECB mode is insecure - patterns in plaintext are visible",
      "suggestion": "Use GCM or CBC mode with proper IV handling",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-path-traversal",
      "name": "Path Traversal Risk",
      "category": "input-validation",
      "pattern": "(?:readFile|writeFile|createReadStream|open)\\s*\\([^)]*(?:req|request|params|query)\\.",
      "message": "File path from user input - potential path traversal",
      "suggestion": "Validate path against allowed directory, use path.resolve() and check prefix",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-redirect-open",
      "name": "Open Redirect",
      "category": "input-validation",
      "pattern": "(?:redirect|location\\.href)\\s*(?:=|\\()\\s*(?:req|request|params|query)\\.",
      "message": "Redirect URL from user input - potential open redirect",
      "suggestion": "Validate redirect URL against allowlist of domains",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-regex-dos",
      "name": "Regex DoS Risk",
      "category": "input-validation",
      "pattern": "new\\s+RegExp\\s*\\([^)]*(?:req|request|params|query|user)",
      "message": "Regex from user input can cause ReDoS attacks",
      "suggestion": "Never construct regex from untrusted input",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-cors-wildcard",
      "name": "CORS Wildcard",
      "category": "headers",
      "pattern": "Access-Control-Allow-Origin['\":\\s]+['\"]\\*['\"]",
      "message": "CORS wildcard allows any origin to access resources",
      "suggestion": "Specify allowed origins explicitly",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Origin_Resource_Sharing_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-http-url",
      "name": "Insecure HTTP URL",
      "category": "transport",
      "pattern": "['\"]http:\\/\\/(?!localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0)",
      "message": "HTTP URLs transmit data without encryption",
      "suggestion": "Use HTTPS for all external communications",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-cookie-no-httponly",
      "name": "Cookie Missing HttpOnly",
      "category": "headers",
      "pattern": "(?:set-cookie|cookie)[^;]*(?!httponly)",
      "message": "Cookie may be missing HttpOnly flag",
      "suggestion": "Set HttpOnly flag to prevent XSS access to cookies",
      "severity": "info",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#httponly-attribute",
      "agentId": "sme-security"
    },
    {
      "id": "security-cookie-no-secure",
      "name": "Cookie Missing Secure Flag",
      "category": "headers",
      "pattern": "(?:set-cookie|cookie).*(?!secure)",
      "message": "Cookie may be missing Secure flag",
      "suggestion": "Set Secure flag to ensure cookie only sent over HTTPS",
      "severity": "info",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#secure-attribute",
      "agentId": "sme-security"
    },
    {
      "id": "security-sensitive-logging",
      "name": "Sensitive Data in Logs",
      "category": "logging",
      "pattern": "(?:console\\.log|logger?\\.\\w+|print)\\s*\\([^)]*(?:password|secret|token|key|credit.?card|ssn)",
      "message": "Potentially logging sensitive data",
      "suggestion": "Never log passwords, tokens, or PII",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html#data-to-exclude",
      "agentId": "sme-security"
    },
    {
      "id": "security-error-stack-exposure",
      "name": "Stack Trace Exposure",
      "category": "logging",
      "pattern": "(?:res\\.send|response\\.send|render)\\s*\\([^)]*(?:err\\.stack|error\\.stack|\\.stack)",
      "message": "Stack traces exposed to users reveal internal details",
      "suggestion": "Log stack traces server-side, show generic error to users",
      "severity": "warning",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-unsafe-deserialize",
      "name": "Unsafe Deserialization",
      "category": "deserialization",
      "pattern": "(?:pickle\\.loads?|yaml\\.load\\s*\\([^)]*Loader\\s*=\\s*yaml\\.(?:Unsafe|Full)Loader|Marshal\\.load|unserialize)\\s*\\(",
      "message": "Unsafe deserialization can lead to remote code execution",
      "suggestion": "Use safe loaders (yaml.safe_load) or validate input first",
      "severity": "error",
      "documentationUrl": "https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html",
      "agentId": "sme-security"
    },
    {
      "id": "security-outdated-jquery",
      "name": "Potentially Outdated jQuery",
      "category": "dependencies",
      "pattern": "jquery[.-](?:1\\.|2\\.[0-2])",
      "message": "jQuery version may have known vulnerabilities",
      "suggestion": "Update to latest jQuery version",
      "severity": "warning",
      "documentationUrl": "https://security.snyk.io/package/npm/jquery",
      "agentId": "sme-security"
    },
    {
      "id": "perf-event-listener-leak",
      "name": "Event Listener Without Cleanup",
      "category": "memory",
      "pattern": "addEventListener\\s*\\([^)]+\\)(?![^}]*removeEventListener)",
      "message": "Event listener may not be removed - potential memory leak",
      "suggestion": "Remove event listeners in cleanup (useEffect return, componentWillUnmount, or beforeDestroy)",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-interval-leak",
      "name": "setInterval Without clearInterval",
      "category": "memory",
      "pattern": "setInterval\\s*\\([^)]+\\)(?![^}]*clearInterval)",
      "message": "Interval may not be cleared - potential memory leak",
      "suggestion": "Store interval ID and clear it in cleanup function",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/setInterval",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-timeout-leak",
      "name": "setTimeout in Loop Without Clear",
      "category": "memory",
      "pattern": "(?:for|while|forEach|map)\\s*\\([^)]*\\)[^{]*\\{[^}]*setTimeout",
      "message": "setTimeout in loop without cleanup can cause issues",
      "suggestion": "Track timeout IDs and clear on unmount/cleanup",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/setTimeout",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-closure-loop",
      "name": "Closure in Loop",
      "category": "memory",
      "pattern": "for\\s*\\([^)]*\\)[^{]*\\{[^}]*function\\s*\\(",
      "message": "Creating functions in loops is inefficient",
      "suggestion": "Define function outside loop or use arrow function with block scope",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#creating_closures_in_loops_a_common_mistake",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-expensive-render",
      "name": "Expensive Computation in Render",
      "category": "memoization",
      "pattern": "(?:render|return)\\s*(?:\\(|\\{)[^}]*\\.(?:filter|map|reduce|sort)\\([^)]+\\)\\.(?:filter|map|reduce|sort)",
      "message": "Chained array operations in render - consider memoization",
      "suggestion": "Use useMemo() to cache computed values",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useMemo",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-inline-object-prop",
      "name": "Inline Object in JSX Props",
      "category": "memoization",
      "pattern": "<\\w+[^>]*\\w+=\\{\\s*\\{[^}]+\\}\\s*\\}",
      "message": "Inline objects create new references on every render",
      "suggestion": "Extract to useMemo() or define outside component",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useMemo#skipping-re-rendering-of-components",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-inline-array-prop",
      "name": "Inline Array in JSX Props",
      "category": "memoization",
      "pattern": "<\\w+[^>]*\\w+=\\{\\s*\\[[^\\]]+\\]\\s*\\}",
      "message": "Inline arrays create new references on every render",
      "suggestion": "Extract to useMemo() or define outside component",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/useMemo",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-no-cache-header",
      "name": "API Response Without Caching",
      "category": "caching",
      "pattern": "fetch\\s*\\([^)]+\\)(?![^}]*cache)",
      "message": "Fetch without cache configuration",
      "suggestion": "Consider adding cache options for GET requests",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/Request/cache",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-large-import",
      "name": "Large Library Import",
      "category": "bundle",
      "pattern": "import\\s+(?:\\*\\s+as\\s+\\w+|\\w+)\\s+from\\s+['\"](?:lodash|moment|rxjs|@material-ui\\/core|antd)['\"]",
      "message": "Importing entire library increases bundle size",
      "suggestion": "Use tree-shakable imports: import { specific } from \"library/specific\"",
      "severity": "warning",
      "documentationUrl": "https://webpack.js.org/guides/tree-shaking/",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-sync-heavy-import",
      "name": "Heavy Module Sync Import",
      "category": "bundle",
      "pattern": "import\\s+\\w+\\s+from\\s+['\"](?:chart\\.js|three|pdf-lib|xlsx|exceljs)['\"]",
      "message": "Heavy library imported synchronously",
      "suggestion": "Use dynamic import: const lib = await import(\"library\")",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-no-code-splitting",
      "name": "Route Without Code Splitting",
      "category": "bundle",
      "pattern": "import\\s+\\w+Page\\s+from.*(?:pages?|views?|screens?)\\/",
      "message": "Page component imported synchronously",
      "suggestion": "Use React.lazy() or dynamic imports for route components",
      "severity": "info",
      "documentationUrl": "https://react.dev/reference/react/lazy",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-layout-thrashing",
      "name": "Potential Layout Thrashing",
      "category": "dom",
      "pattern": "(?:offset(?:Width|Height|Top|Left)|client(?:Width|Height)|getComputedStyle|getBoundingClientRect)[^;]*(?:style\\.|classList)",
      "message": "Reading layout then writing style causes layout thrashing",
      "suggestion": "Batch reads before writes, or use requestAnimationFrame",
      "severity": "warning",
      "documentationUrl": "https://web.dev/avoid-large-complex-layouts-and-layout-thrashing/",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-document-write",
      "name": "document.write Usage",
      "category": "dom",
      "pattern": "document\\.write\\s*\\(",
      "message": "document.write blocks parsing and is slow",
      "suggestion": "Use DOM manipulation methods instead",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/Document/write",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-sync-xhr",
      "name": "Synchronous XMLHttpRequest",
      "category": "dom",
      "pattern": "\\.open\\s*\\([^)]*,\\s*[^)]*,\\s*false\\s*\\)",
      "message": "Synchronous XHR blocks the main thread",
      "suggestion": "Use async XHR or fetch API",
      "severity": "error",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-force-reflow",
      "name": "Forced Synchronous Layout",
      "category": "dom",
      "pattern": "(?:for|while)\\s*\\([^)]*\\)[^{]*\\{[^}]*(?:offsetWidth|offsetHeight|clientWidth|clientHeight)",
      "message": "Reading layout properties in loop forces reflow",
      "suggestion": "Cache layout values outside loop",
      "severity": "warning",
      "documentationUrl": "https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-n-plus-one-loop",
      "name": "Database Query in Loop",
      "category": "database",
      "pattern": "(?:for|forEach|map)\\s*\\([^)]*\\)[^{]*\\{[^}]*(?:\\.find\\(|\\.query\\(|\\.execute\\(|SELECT\\s)",
      "message": "Database query inside loop causes N+1 problem",
      "suggestion": "Batch queries or use eager loading",
      "severity": "warning",
      "documentationUrl": "https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem-in-orm-object-relational-mapping",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-api-in-loop",
      "name": "API Call in Loop",
      "category": "network",
      "pattern": "(?:for|forEach|map)\\s*\\([^)]*\\)[^{]*\\{[^}]*(?:fetch\\(|axios\\.|http\\.)",
      "message": "API call inside loop - consider batching",
      "suggestion": "Use Promise.all() or batch API endpoint",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-unbounded-query",
      "name": "Query Without Limit",
      "category": "database",
      "pattern": "\\.find\\s*\\(\\s*\\{[^}]*\\}\\s*\\)(?![^;]*\\.limit)",
      "message": "Database query without limit can return unbounded results",
      "suggestion": "Add .limit() to prevent large result sets",
      "severity": "info",
      "documentationUrl": "https://www.mongodb.com/docs/manual/reference/method/cursor.limit/",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-nested-loops",
      "name": "Deeply Nested Loops",
      "category": "algorithm",
      "pattern": "for\\s*\\([^)]*\\)[^{]*\\{[^}]*for\\s*\\([^)]*\\)[^{]*\\{[^}]*for\\s*\\(",
      "message": "Triple nested loops indicate O(n) complexity",
      "suggestion": "Consider refactoring with maps, sets, or different algorithm",
      "severity": "warning",
      "documentationUrl": "https://www.bigocheatsheet.com/",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-array-includes-loop",
      "name": "Array.includes in Loop",
      "category": "algorithm",
      "pattern": "(?:for|while|forEach|map)\\s*\\([^)]*\\)[^{]*\\{[^}]*\\.includes\\s*\\(",
      "message": "includes() in loop is O(n) - use Set for O(n)",
      "suggestion": "Convert array to Set before loop for O(1) lookups",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-inefficient-string-concat",
      "name": "String Concatenation in Loop",
      "category": "algorithm",
      "pattern": "(?:for|while)\\s*\\([^)]*\\)[^{]*\\{[^}]*\\+\\s*=\\s*['\"`]",
      "message": "String concatenation in loop is inefficient",
      "suggestion": "Use array.join() or template literals",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-large-image-import",
      "name": "Large Image Import",
      "category": "assets",
      "pattern": "import\\s+\\w+\\s+from\\s+['\"][^'\"]+\\.(?:png|jpg|jpeg|gif)['\"]",
      "message": "Importing images directly bundles them",
      "suggestion": "Use optimized image loading or CDN",
      "severity": "info",
      "documentationUrl": "https://web.dev/fast/#optimize-your-images",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-no-image-dimensions",
      "name": "Image Without Dimensions",
      "category": "assets",
      "pattern": "<img[^>]*src=[^>]*(?!width|height)[^>]*>",
      "message": "Images without dimensions cause layout shift",
      "suggestion": "Add width and height attributes to prevent CLS",
      "severity": "info",
      "documentationUrl": "https://web.dev/optimize-cls/#images-without-dimensions",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-console-in-production",
      "name": "Console Statement",
      "category": "debug",
      "pattern": "console\\.(?:log|warn|error|info|debug|trace)\\s*\\(",
      "message": "Console statements affect performance in production",
      "suggestion": "Remove or use build-time stripping",
      "severity": "info",
      "documentationUrl": "https://developer.chrome.com/docs/devtools/console/api/",
      "agentId": "sme-performance"
    },
    {
      "id": "perf-debugger-statement",
      "name": "Debugger Statement",
      "category": "debug",
      "pattern": "\\bdebugger\\b",
      "message": "Debugger statement should not be in production code",
      "suggestion": "Remove debugger statement",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger",
      "agentId": "sme-performance"
    },
    {
      "id": "a11y-img-no-alt",
      "name": "Image Without Alt Text",
      "category": "images",
      "pattern": "<img[^>]*(?!alt=)[^>]*>",
      "message": "Image missing alt attribute - screen readers cannot describe it",
      "suggestion": "Add alt=\"description\" or alt=\"\" for decorative images",
      "severity": "error",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/images/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-img-empty-alt",
      "name": "Image With Empty Alt (Check if Decorative)",
      "category": "images",
      "pattern": "<img[^>]*alt\\s*=\\s*[\"'][\"'][^>]*>",
      "message": "Empty alt is correct only for decorative images",
      "suggestion": "Verify image is purely decorative, otherwise add description",
      "severity": "info",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/images/decorative/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-svg-no-title",
      "name": "SVG Without Title",
      "category": "images",
      "pattern": "<svg[^>]*>(?![^<]*<title)",
      "message": "SVG missing title element for accessibility",
      "suggestion": "Add <title> as first child of SVG, and aria-labelledby",
      "severity": "warning",
      "documentationUrl": "https://css-tricks.com/accessible-svgs/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-video-no-captions",
      "name": "Video Without Captions",
      "category": "media",
      "pattern": "<video[^>]*>(?![^<]*<track[^>]*kind\\s*=\\s*[\"']captions)",
      "message": "Video may be missing captions track",
      "suggestion": "Add <track kind=\"captions\"> for deaf/hard-of-hearing users",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/media/av/captions/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-div-button",
      "name": "Div Used as Button",
      "category": "semantic",
      "pattern": "<div[^>]*onClick|<div[^>]*@click",
      "message": "Div with click handler should be a button element",
      "suggestion": "Use <button> for clickable elements - provides focus and keyboard support",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/button_role",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-span-link",
      "name": "Span Used as Link",
      "category": "semantic",
      "pattern": "<span[^>]*onClick[^>]*>.*(?:click|here|link)",
      "message": "Span with click handler for navigation should be an anchor",
      "suggestion": "Use <a href=\"...\"> for navigation",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-heading-skip",
      "name": "Skipped Heading Level",
      "category": "semantic",
      "pattern": "<h1[^>]*>[\\s\\S]*<h3|<h2[^>]*>[\\s\\S]*<h4|<h3[^>]*>[\\s\\S]*<h5",
      "message": "Heading levels should not skip (h1 -> h3)",
      "suggestion": "Use sequential heading levels for proper document structure",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/page-structure/headings/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-no-landmark",
      "name": "Missing Landmark Regions",
      "category": "semantic",
      "pattern": "<body[^>]*>(?![^]*<(?:main|header|footer|nav|aside))",
      "message": "Page may be missing landmark regions",
      "suggestion": "Use <main>, <header>, <footer>, <nav> for page structure",
      "severity": "info",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/page-structure/regions/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-table-no-headers",
      "name": "Table Without Headers",
      "category": "semantic",
      "pattern": "<table[^>]*>(?![^]*<th)",
      "message": "Data table missing header cells",
      "suggestion": "Use <th> elements with scope attribute for table headers",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/tables/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-aria-hidden-focusable",
      "name": "Hidden Element Contains Focusable",
      "category": "aria",
      "pattern": "aria-hidden\\s*=\\s*[\"']true[\"'][^>]*>[^<]*<(?:a|button|input|select|textarea)",
      "message": "aria-hidden element contains focusable children",
      "suggestion": "Remove focusable elements from aria-hidden containers or use inert",
      "severity": "error",
      "documentationUrl": "https://www.w3.org/WAI/ARIA/apg/practices/hiding-semantics/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-invalid-aria-role",
      "name": "Invalid ARIA Role",
      "category": "aria",
      "pattern": "role\\s*=\\s*[\"'](?!alert|alertdialog|application|article|banner|button|cell|checkbox|columnheader|combobox|complementary|contentinfo|definition|dialog|directory|document|feed|figure|form|grid|gridcell|group|heading|img|link|list|listbox|listitem|log|main|marquee|math|menu|menubar|menuitem|menuitemcheckbox|menuitemradio|meter|navigation|none|note|option|presentation|progressbar|radio|radiogroup|region|row|rowgroup|rowheader|scrollbar|search|searchbox|separator|slider|spinbutton|status|switch|tab|table|tablist|tabpanel|term|textbox|timer|toolbar|tooltip|tree|treegrid|treeitem)[\"']",
      "message": "Invalid or misspelled ARIA role",
      "suggestion": "Use a valid ARIA role from the specification",
      "severity": "error",
      "documentationUrl": "https://www.w3.org/TR/wai-aria-1.2/#role_definitions",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-redundant-role",
      "name": "Redundant ARIA Role",
      "category": "aria",
      "pattern": "<button[^>]*role\\s*=\\s*[\"']button[\"']|<a[^>]*href[^>]*role\\s*=\\s*[\"']link[\"']|<nav[^>]*role\\s*=\\s*[\"']navigation[\"']",
      "message": "ARIA role is redundant with native element semantics",
      "suggestion": "Remove redundant role - native elements have implicit roles",
      "severity": "info",
      "documentationUrl": "https://www.w3.org/TR/using-aria/#rule1",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-missing-aria-label",
      "name": "Icon Button Without Label",
      "category": "aria",
      "pattern": "<button[^>]*>[^<]*<(?:svg|i|span[^>]*class[^>]*icon)[^<]*<\\/button>",
      "message": "Button with only icon needs accessible label",
      "suggestion": "Add aria-label or visually hidden text",
      "severity": "error",
      "documentationUrl": "https://www.sarasoueidan.com/blog/accessible-icon-buttons/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-positive-tabindex",
      "name": "Positive tabIndex",
      "category": "keyboard",
      "pattern": "tabIndex\\s*=\\s*\\{?\\s*[1-9]|tabindex\\s*=\\s*[\"'][1-9]",
      "message": "Positive tabIndex disrupts natural tab order",
      "suggestion": "Use tabIndex={0} or tabIndex={-1} only",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-mouse-only-event",
      "name": "Mouse-Only Event Handler",
      "category": "keyboard",
      "pattern": "onMouseDown\\s*=(?![^>]*onKeyDown)|@mousedown(?![^>]*@keydown)",
      "message": "Mouse event without keyboard equivalent",
      "suggestion": "Add onKeyDown handler for keyboard users",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Understanding/keyboard.html",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-outline-none",
      "name": "Focus Outline Removed",
      "category": "keyboard",
      "pattern": "outline\\s*:\\s*(?:none|0)|:focus\\s*\\{[^}]*outline\\s*:\\s*none",
      "message": "Removing focus outline makes keyboard navigation difficult",
      "suggestion": "Provide custom focus styles instead of removing outline",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Understanding/focus-visible.html",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-no-focus-trap",
      "name": "Modal Without Focus Trap",
      "category": "keyboard",
      "pattern": "<(?:dialog|div[^>]*(?:modal|dialog))[^>]*>(?![^]*(?:focus-trap|FocusTrap|useFocusTrap))",
      "message": "Modal dialog may not trap focus properly",
      "suggestion": "Implement focus trap to keep focus within modal",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-input-no-label",
      "name": "Input Without Label",
      "category": "forms",
      "pattern": "<input[^>]*(?!aria-label|aria-labelledby|id\\s*=\\s*[\"'][^\"']+[\"'][^>]*<label[^>]*for)[^>]*>",
      "message": "Form input missing associated label",
      "suggestion": "Add <label htmlFor=\"id\"> or aria-label attribute",
      "severity": "error",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/forms/labels/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-placeholder-only-label",
      "name": "Placeholder as Only Label",
      "category": "forms",
      "pattern": "<input[^>]*placeholder\\s*=[^>]*(?!aria-label|<label)",
      "message": "Placeholder should not be the only label",
      "suggestion": "Add a proper label - placeholders disappear when typing",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/forms/labels/#placeholder-text",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-form-error-no-aria",
      "name": "Form Error Without ARIA",
      "category": "forms",
      "pattern": "(?:error|invalid)[^>]*(?:className|class)[^>]*>(?![^<]*aria-live|aria-describedby)",
      "message": "Form error message may not be announced to screen readers",
      "suggestion": "Use aria-live=\"polite\" or aria-describedby for error messages",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/tutorials/forms/notifications/",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-required-no-aria",
      "name": "Required Field Without ARIA",
      "category": "forms",
      "pattern": "<input[^>]*required[^>]*(?!aria-required)",
      "message": "Required attribute should have aria-required for older AT",
      "suggestion": "Add aria-required=\"true\" for better screen reader support",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-required",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-color-only-indicator",
      "name": "Color as Only Indicator",
      "category": "color",
      "pattern": "(?:color|background)\\s*:\\s*(?:red|green|#ff0000|#00ff00)[^;]*;(?![^}]*(?:border|text-decoration|font-weight))",
      "message": "Color should not be the only way to convey information",
      "suggestion": "Add icons, text, or patterns alongside color indicators",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Understanding/use-of-color.html",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-live-region-missing",
      "name": "Dynamic Content Without Live Region",
      "category": "dynamic",
      "pattern": "(?:toast|notification|alert|snackbar)[^>]*(?:className|class)[^>]*>(?![^<]*aria-live|role\\s*=\\s*[\"'](?:alert|status))",
      "message": "Dynamic notification may not be announced to screen readers",
      "suggestion": "Add aria-live=\"polite\" or role=\"status\" for announcements",
      "severity": "warning",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Live_Regions",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-loading-no-announcement",
      "name": "Loading State Not Announced",
      "category": "dynamic",
      "pattern": "(?:loading|spinner|isLoading)[^>]*(?:className|class)[^>]*>(?![^<]*aria-busy|aria-live)",
      "message": "Loading state may not be communicated to screen readers",
      "suggestion": "Add aria-busy=\"true\" or aria-live announcement",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-busy",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-link-no-text",
      "name": "Link Without Text",
      "category": "links",
      "pattern": "<a[^>]*href[^>]*>\\s*<(?:img|svg|i)[^>]*>\\s*<\\/a>",
      "message": "Link contains only image/icon without text alternative",
      "suggestion": "Add aria-label or visually hidden text to link",
      "severity": "error",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Techniques/html/H30",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-link-click-here",
      "name": "Non-Descriptive Link Text",
      "category": "links",
      "pattern": "<a[^>]*>[^<]*(?:click\\s*here|read\\s*more|learn\\s*more|here)\\s*<\\/a>",
      "message": "Link text should describe the destination, not the action",
      "suggestion": "Use descriptive text like \"View our pricing plans\"",
      "severity": "info",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Understanding/link-purpose-in-context.html",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-link-new-tab-no-warning",
      "name": "New Tab Link Without Warning",
      "category": "links",
      "pattern": "target\\s*=\\s*[\"']_blank[\"'](?![^>]*(?:opens\\s*in\\s*new|external|new\\s*window|aria-label))",
      "message": "Links opening in new tab should warn users",
      "suggestion": "Add \"(opens in new tab)\" text or icon with aria-label",
      "severity": "info",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Techniques/general/G201",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-autoplay-media",
      "name": "Autoplaying Media",
      "category": "timing",
      "pattern": "<(?:video|audio)[^>]*autoplay",
      "message": "Autoplaying media can be disorienting and annoying",
      "suggestion": "Let users control playback, or limit autoplay to 5 seconds",
      "severity": "warning",
      "documentationUrl": "https://www.w3.org/WAI/WCAG21/Understanding/audio-control.html",
      "agentId": "sme-accessibility"
    },
    {
      "id": "a11y-animation-no-reduce",
      "name": "Animation Without Motion Preference",
      "category": "motion",
      "pattern": "animation(?:-name)?\\s*:\\s*[^;]+;(?![^}]*prefers-reduced-motion)",
      "message": "Animations should respect prefers-reduced-motion",
      "suggestion": "Use @media (prefers-reduced-motion: reduce) to disable animations",
      "severity": "info",
      "documentationUrl": "https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion",
      "agentId": "sme-accessibility"
    },
    {
      "id": "test-no-assertion",
      "name": "Test Without Assertion",
      "category": "structure",
      "pattern": "(?:it|test)\\s*\\([^,]+,\\s*(?:async\\s*)?\\(\\s*\\)\\s*=>\\s*\\{[^}]*\\}\\s*\\)(?![^}]*(?:expect|assert|should))",
      "message": "Test appears to have no assertions",
      "suggestion": "Every test should have at least one assertion",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/expect",
      "agentId": "sme-testing"
    },
    {
      "id": "test-multiple-assertions",
      "name": "Too Many Assertions",
      "category": "structure",
      "pattern": "(?:it|test)\\s*\\([^)]+\\)[^{]*\\{[^}]*(?:expect|assert)[^}]*(?:expect|assert)[^}]*(?:expect|assert)[^}]*(?:expect|assert)[^}]*(?:expect|assert)",
      "message": "Test has many assertions - consider splitting",
      "suggestion": "Each test should focus on one behavior",
      "severity": "info",
      "documentationUrl": "https://kentcdodds.com/blog/write-fewer-longer-tests",
      "agentId": "sme-testing"
    },
    {
      "id": "test-nested-describe",
      "name": "Deeply Nested Describe Blocks",
      "category": "structure",
      "pattern": "describe\\s*\\([^{]*\\{[^}]*describe\\s*\\([^{]*\\{[^}]*describe\\s*\\(",
      "message": "Deeply nested describe blocks can be hard to follow",
      "suggestion": "Limit nesting to 2 levels, or split into separate files",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/api#describename-fn",
      "agentId": "sme-testing"
    },
    {
      "id": "test-duplicate-name",
      "name": "Generic Test Name",
      "category": "structure",
      "pattern": "(?:it|test)\\s*\\(\\s*['\"](?:works|should work|test|it works|does something)['\"]",
      "message": "Test name is too generic",
      "suggestion": "Use descriptive names: \"should return null when input is empty\"",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/api#testname-fn-timeout",
      "agentId": "sme-testing"
    },
    {
      "id": "test-mock-not-restored",
      "name": "Mock Not Restored",
      "category": "mocking",
      "pattern": "jest\\.(?:spyOn|mock)\\s*\\([^)]+\\)(?![^}]*(?:mockRestore|restoreAllMocks|clearAllMocks))",
      "message": "Mock may not be restored after test",
      "suggestion": "Use jest.restoreAllMocks() in afterEach or mockRestore()",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/mock-function-api#mockfnmockrestore",
      "agentId": "sme-testing"
    },
    {
      "id": "test-mock-implementation-complex",
      "name": "Complex Mock Implementation",
      "category": "mocking",
      "pattern": "mockImplementation\\s*\\(\\s*(?:async\\s*)?\\([^)]*\\)\\s*=>\\s*\\{[^}]{100,}\\}",
      "message": "Mock implementation is too complex",
      "suggestion": "Extract complex mock logic to a fixture or factory function",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/mock-functions#mock-implementations",
      "agentId": "sme-testing"
    },
    {
      "id": "test-mock-module-inline",
      "name": "Inline Module Mock",
      "category": "mocking",
      "pattern": "jest\\.mock\\s*\\([^,]+,\\s*\\(\\s*\\)\\s*=>\\s*\\(\\s*\\{[^}]{200,}\\}",
      "message": "Large inline mock - consider using __mocks__ folder",
      "suggestion": "Move complex mocks to __mocks__/moduleName.js",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/manual-mocks",
      "agentId": "sme-testing"
    },
    {
      "id": "test-real-timer",
      "name": "Using Real Timers",
      "category": "mocking",
      "pattern": "(?:setTimeout|setInterval)\\s*\\([^)]+,\\s*\\d{4,}\\)",
      "message": "Test uses real timer with long delay",
      "suggestion": "Use jest.useFakeTimers() and jest.runAllTimers()",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/timer-mocks",
      "agentId": "sme-testing"
    },
    {
      "id": "test-expect-true",
      "name": "Expect toBe(true)",
      "category": "assertions",
      "pattern": "expect\\s*\\([^)]+\\)\\s*\\.toBe\\s*\\(\\s*true\\s*\\)",
      "message": "toBe(true) is less informative than specific matchers",
      "suggestion": "Use specific matchers: toBeTruthy(), toHaveBeenCalled(), etc.",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/expect",
      "agentId": "sme-testing"
    },
    {
      "id": "test-expect-false",
      "name": "Expect toBe(false)",
      "category": "assertions",
      "pattern": "expect\\s*\\([^)]+\\)\\s*\\.toBe\\s*\\(\\s*false\\s*\\)",
      "message": "toBe(false) is less informative than specific matchers",
      "suggestion": "Use specific matchers: toBeFalsy(), not.toHaveBeenCalled(), etc.",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/expect",
      "agentId": "sme-testing"
    },
    {
      "id": "test-expect-not-defined",
      "name": "Expect Not toBeDefined",
      "category": "assertions",
      "pattern": "expect\\s*\\([^)]+\\)\\s*\\.not\\s*\\.toBeDefined\\s*\\(\\s*\\)",
      "message": "not.toBeDefined() is less clear than toBeUndefined()",
      "suggestion": "Use toBeUndefined() for clearer intent",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/expect#tobeundefined",
      "agentId": "sme-testing"
    },
    {
      "id": "test-expect-length",
      "name": "Expect Array Length",
      "category": "assertions",
      "pattern": "expect\\s*\\([^)]+\\.length\\s*\\)\\s*\\.toBe",
      "message": "Checking .length.toBe() can be replaced with toHaveLength()",
      "suggestion": "Use expect(arr).toHaveLength(n) for better error messages",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/expect#tohavelengthnumber",
      "agentId": "sme-testing"
    },
    {
      "id": "test-snapshot-large",
      "name": "Large Snapshot",
      "category": "assertions",
      "pattern": "expect\\s*\\([^)]+\\)\\s*\\.toMatchSnapshot\\s*\\(\\s*\\)(?=[^}]{500,})",
      "message": "Large snapshots are hard to review and maintain",
      "suggestion": "Use inline snapshots or test specific properties",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/snapshot-testing#best-practices",
      "agentId": "sme-testing"
    },
    {
      "id": "test-async-no-await",
      "name": "Async Test Without Await",
      "category": "async",
      "pattern": "(?:it|test)\\s*\\([^,]+,\\s*async\\s*\\([^)]*\\)\\s*=>\\s*\\{(?![^}]*await)",
      "message": "Async test function does not use await",
      "suggestion": "Use await for async operations or remove async keyword",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/asynchronous",
      "agentId": "sme-testing"
    },
    {
      "id": "test-promise-not-returned",
      "name": "Promise Not Returned",
      "category": "async",
      "pattern": "(?:it|test)\\s*\\([^,]+,\\s*\\(\\s*\\)\\s*=>\\s*\\{[^}]*Promise[^}]*(?!\\breturn\\b)",
      "message": "Promise in test may not be awaited",
      "suggestion": "Return the promise or use async/await",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/asynchronous#promises",
      "agentId": "sme-testing"
    },
    {
      "id": "test-done-callback",
      "name": "Using Done Callback",
      "category": "async",
      "pattern": "(?:it|test)\\s*\\([^,]+,\\s*\\(\\s*done\\s*\\)\\s*=>",
      "message": "done callback is error-prone",
      "suggestion": "Prefer async/await or returning promises",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/asynchronous#callbacks",
      "agentId": "sme-testing"
    },
    {
      "id": "test-expect-in-catch",
      "name": "Expect in Catch Block",
      "category": "async",
      "pattern": "catch\\s*\\([^)]*\\)\\s*\\{[^}]*expect",
      "message": "Expect in catch may not run if no error is thrown",
      "suggestion": "Use expect().rejects or expect.assertions(n)",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/expect#rejects",
      "agentId": "sme-testing"
    },
    {
      "id": "test-shared-state",
      "name": "Shared Mutable State",
      "category": "isolation",
      "pattern": "(?:let|var)\\s+\\w+\\s*=\\s*(?:\\[|\\{|null|undefined)[^;]*;[^}]*describe\\s*\\(",
      "message": "Tests may share mutable state defined outside test blocks",
      "suggestion": "Initialize state in beforeEach or inside each test",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/setup-teardown",
      "agentId": "sme-testing"
    },
    {
      "id": "test-order-dependent",
      "name": "Test Order Dependency",
      "category": "isolation",
      "pattern": "(?:it|test)\\s*\\([^)]+first[^)]*\\)|(?:it|test)\\s*\\([^)]+then[^)]*\\)|(?:it|test)\\s*\\([^)]+after[^)]*\\)",
      "message": "Test name suggests order dependency",
      "suggestion": "Tests should be independent and run in any order",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/setup-teardown#repeating-setup",
      "agentId": "sme-testing"
    },
    {
      "id": "test-hardcoded-date",
      "name": "Hardcoded Date in Test",
      "category": "isolation",
      "pattern": "new\\s+Date\\s*\\(\\s*['\"](?:2023|2024|2025|2026)",
      "message": "Hardcoded date may cause test to fail in future",
      "suggestion": "Use jest.useFakeTimers() and setSystemTime()",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/timer-mocks#advance-timers-by-time",
      "agentId": "sme-testing"
    },
    {
      "id": "test-skip",
      "name": "Skipped Test",
      "category": "coverage",
      "pattern": "(?:it|test|describe)\\.skip\\s*\\(",
      "message": "Skipped test found",
      "suggestion": "Fix or remove skipped tests before merging",
      "severity": "warning",
      "documentationUrl": "https://jestjs.io/docs/api#testskipname-fn",
      "agentId": "sme-testing"
    },
    {
      "id": "test-only",
      "name": "Focused Test (.only)",
      "category": "coverage",
      "pattern": "(?:it|test|describe)\\.only\\s*\\(",
      "message": ".only will skip other tests - remove before commit",
      "suggestion": "Remove .only to run all tests",
      "severity": "error",
      "documentationUrl": "https://jestjs.io/docs/api#testonlyname-fn-timeout",
      "agentId": "sme-testing"
    },
    {
      "id": "test-todo",
      "name": "Test TODO",
      "category": "coverage",
      "pattern": "(?:it|test)\\.todo\\s*\\(",
      "message": "TODO test found - needs implementation",
      "suggestion": "Implement or create ticket for pending test",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/api#testtodoname",
      "agentId": "sme-testing"
    },
    {
      "id": "test-console-log",
      "name": "Console.log in Test",
      "category": "quality",
      "pattern": "console\\.log\\s*\\(",
      "message": "Console.log in test - remove debug output",
      "suggestion": "Remove console statements or use debugger",
      "severity": "info",
      "documentationUrl": "https://jestjs.io/docs/troubleshooting",
      "agentId": "sme-testing"
    },
    {
      "id": "test-wait-for-empty",
      "name": "Empty waitFor",
      "category": "testing-library",
      "pattern": "waitFor\\s*\\(\\s*(?:async\\s*)?\\(\\s*\\)\\s*=>\\s*\\{\\s*\\}\\s*\\)",
      "message": "waitFor with empty callback does nothing",
      "suggestion": "Add assertion inside waitFor callback",
      "severity": "error",
      "documentationUrl": "https://testing-library.com/docs/dom-testing-library/api-async/#waitfor",
      "agentId": "sme-testing"
    },
    {
      "id": "test-query-by-test-id",
      "name": "getByTestId Overuse",
      "category": "testing-library",
      "pattern": "getByTestId\\s*\\([^)]+\\)(?:[^}]*getByTestId){2,}",
      "message": "Multiple getByTestId - prefer accessible queries",
      "suggestion": "Use getByRole, getByLabelText for better accessibility testing",
      "severity": "info",
      "documentationUrl": "https://testing-library.com/docs/queries/about/#priority",
      "agentId": "sme-testing"
    },
    {
      "id": "test-container-query",
      "name": "Container Query",
      "category": "testing-library",
      "pattern": "container\\.querySelector\\s*\\(",
      "message": "Avoid container.querySelector - use screen queries",
      "suggestion": "Use screen.getByRole() or other Testing Library queries",
      "severity": "warning",
      "documentationUrl": "https://testing-library.com/docs/queries/about/",
      "agentId": "sme-testing"
    },
    {
      "id": "test-fire-event-click",
      "name": "fireEvent Instead of userEvent",
      "category": "testing-library",
      "pattern": "fireEvent\\.click\\s*\\(",
      "message": "fireEvent.click doesnt simulate real user behavior",
      "suggestion": "Use userEvent.click() for realistic interaction testing",
      "severity": "info",
      "documentationUrl": "https://testing-library.com/docs/user-event/intro/",
      "agentId": "sme-testing"
    }
  ],
  "metadata": {
    "generatedAt": "2026-01-04T18:45:45.984Z",
    "patternCount": 212,
    "agentCount": 9
  }
}